server.modules = (
	"mod_access",
	"mod_alias",
	"mod_compress",
 	"mod_redirect",
 	"mod_accesslog",
 	"mod_cgi",
       "mod_rewrite",
       "mod_proxy",
)

server.upload-dirs	    = ("/var/cache/lighttpd/uploads")

server.document-root        = "/home/www/blunderer.org/www/"
index-file.names            = ( "index.php", "index.html",
                                "index.htm", "default.htm",
                               " index.lighttpd.html" )

url.access-deny             = ( "~", ".inc" )

static-file.exclude-extensions = ( ".php", ".pl", ".fcgi" )

include_shell "/usr/share/lighttpd/use-ipv6.pl"

dir-listing.encoding        = "utf-8"
server.dir-listing          = "enable"

compress.cache-dir          = "/var/cache/lighttpd/compress/"
compress.filetype           = ( "application/x-javascript", "text/css", "text/html", "text/plain" )

include_shell "/usr/share/lighttpd/create-mime.assign.pl"
include_shell "/usr/share/lighttpd/include-conf-enabled.pl"

accesslog.filename	    = "/tmp/plop_log" 
accesslog.format	    = "%m %U %f %q" 

#ssl.engine = "enable"
#ssl.pemfile = "/etc/lighttpd/keys/server.pem"

# Libroxml.net
$HTTP["host"] =~ "^(download|downloads|dl)\.libroxml\.(net|com)$" {
	url.rewrite-once = ( "^/pool(.*)$" => "/index.php?path=$1" )
	server.document-root        = "/home/www/libroxml.net/download"
}
$HTTP["host"] =~ "^debian\.libroxml\.(net|com)$" {
	server.document-root        = "/home/www/libroxml.net/debian"
}
$HTTP["host"] =~ "(^|www\.)libroxml\.(net|com)$" {
	server.document-root        = "/home/www/libroxml.net/www"
}

# Blunderer.org
$HTTP["host"] =~ "^1000at8\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/1000@8"
}
$HTTP["host"] =~ "^(download|downloads|dl)\.blunderer\.(org|net|fr)" {
	url.rewrite-once = ( "^/pool(.*)$" => "/index.php?path=$1" )
	server.document-root        = "/home/www/blunderer.org/download"
}
$HTTP["host"] =~ "^home\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/www"
}
$HTTP["host"] =~ "^cortex\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/cortex"
}
$HTTP["host"] =~ "^manett\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/manett"
}
$HTTP["host"] =~ "^prihse-ppms\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/prihse-ppms"
}
$HTTP["host"] =~ "^la-corde-au-cou\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/la-corde-au-cou"
}
$HTTP["host"] =~ "^lacordeaucou\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/la-corde-au-cou"
}
$HTTP["host"] =~ "^mangakanime\.blunderer\.(org|net|fr)" {
	server.document-root        = "/home/www/blunderer.org/mangakanime"
}
$HTTP["host"] =~ "^ml\.blunderer\.(org|net|fr)" {
        server.document-root = "/usr/lib/cgi-bin/mailman"

        server.name = "ml.blunderer.org"

	server.dir-listing = "disable" 

	alias.url += (
	"/mailman/" => "/usr/lib/cgi-bin/mailman",
	"/pipermail/" => "/var/lib/mailman/archives/public",
	"/images/mailman/" => "/usr/share/images/mailman", 
	)

	cgi.assign = (
	"/admin" => "",
	"/admindb" => "",
	"/confirm" => "",
	"/create" => "",
	"/edithtml" => "",
	"/listinfo" => "",
	"/options" => "",
	"/private" => "",
	"/rmlist" => "",
	"/roster" => "",
	"/subscribe" => "" 
	)

	url.rewrite = ( 
	"^/$" => "/listinfo",
	"^/mailman/$" => "/mailman/listinfo" 
	)
}
$HTTP["host"] =~ "^(source|code|git|gogs)\.blunderer\.(org|net|fr)" {
	proxy.server = ( "" =>
                       ( ( 
                           "host" => "127.0.0.1",
                           "port" => 3000
                         ) )
                     )
}

# Share folders
$HTTP["host"] =~ "^share\.blunderer\.(org|net|fr)" {
	server.document-root = "/home/www/blunderer.org/share/lufi"
	proxy.server = ( "" =>
			( (
			   "host" => "127.0.0.1",
			   "port" => 8080 
			  ) )
		       )

	#server.dir-listing = "disable"
	#$HTTP["url"] =~ "^/cc63e3bb4653720ce53172fb0d979da8" {
	#	#server.errorlog = "/home/opahz/www/error.log"
	#	#server.username = "opahz"
	#	#server.groupname = "opahz"
	#	server.document-root = "/home/opahz/www"
	#}
	#$HTTP["url"] =~ "^/5d2f065cdaa746d9dbbb7cc5db27700c" {
	#	#server.errorlog = "/home/blunderer/www/error.log"
	#	#server.username = "blunderer"
	#	#server.groupname = "blunderer"
	#	server.document-root = "/home/blunderer/www"
	#}
}

server.username             = "www-data"
server.groupname            = "www-data"
server.errorlog             = "/var/log/lighttpd/error.log"
server.pid-file             = "/var/run/lighttpd.pid"

